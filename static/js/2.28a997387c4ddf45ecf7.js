webpackJsonp([2],{"5PlU":function(t,i,n){var e=n("RY/4"),o=n("dSzd")("iterator"),a=n("/bQp");t.exports=n("FeBl").isIterable=function(t){var i=Object(t);return void 0!==i[o]||"@@iterator"in i||a.hasOwnProperty(e(i))}},"99FF":function(t,i,n){var e=n("znm1");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);n("rjj0")("593ee8a7",e,!1)},BO1k:function(t,i,n){t.exports={default:n("fxRn"),__esModule:!0}},CdO4:function(t,i,n){var e=n("wD52");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);n("rjj0")("72a4c8e2",e,!1)},DCXW:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=n("mvHQ"),o=n.n(e),a=n("d7EF"),s=n.n(a),r=n("BO1k"),l=n.n(r),d=n("Dd8w"),c=n.n(d),u=n("xUx1"),p=n("0xDb"),f=n("NYxO"),h=n("zyxP"),m=n.n(h),b=n("ocgh"),v=n("YaEn");i.default={components:{uploadPhotos:m.a},data:function(){return{albumInfo:{},isEdit:!1,snap:null,isCanUpload:!1,pic_ids_snap:"",pic_ids:""}},created:function(){this.getPhotos()},computed:c()({},n.i(f.b)(["storeList"]),{store:function(){var t=!0,i=!1,n=void 0;try{for(var e,o=l()(this.storeList);!(t=(e=o.next()).done);t=!0){var a=e.value;if(this.albumInfo.store_id==a.id)return a.name}}catch(t){i=!0,n=t}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}},photoList:function(){if(this.albumInfo&&this.albumInfo.pic_ids){var t=this.albumInfo.pic_ids.split(","),i=[],n=!0,e=!1,o=void 0;try{for(var a,r=l()(this.albumInfo.pic.entries());!(n=(a=r.next()).done);n=!0){var d=a.value,c=s()(d,2),u=c[0],p=c[1];i[u]={pic_url:"http://"+p,pic_id:t[u]}}}catch(t){e=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(e)throw o}}return i}return[]},isCanSubmit:function(){return this.albumInfo.title!==this.snap.title||this.albumInfo.store_id!==this.snap.store_id||this.albumInfo.cover_id!==this.snap.cover_id},isCanUploadSubmit:function(){return this.pic_ids!==this.snap.pic_ids}}),methods:{getPhotos:function(){var t=this,i={id:this.$route.params.id};n.i(u.d)(i).then(function(i){t.albumInfo=i.data})},formatDateTime:function(t){return n.i(p.a)(t)},emitFile:function(){this.$refs.file.click()},upload:function(t){var i=this,e=t.target.files[0],o=new FormData;o.append("image",e,e.name),o.append("chunk","0"),n.i(b.c)(o).then(function(t){i.albumInfo.cover_pic=t.data.pic_address,i.albumInfo.cover_id=t.data.pic_id})},editBtn:function(){this.isEdit=!0,this.snap=JSON.parse(o()(this.albumInfo))},cancel:function(){this.isEdit=!1,this.albumInfo=JSON.parse(o()(this.snap))},uploadBtn:function(){this.isCanUpload=!0,this.pic_ids=this.albumInfo.pic_ids,this.snap=JSON.parse(o()(this.albumInfo))},uploadCancel:function(){var t=this;this.isCanUploadSubmit?this.$confirm("尚未保存，确定取消？").then(function(i){t.isCanUpload=!1,t.albumInfo=JSON.parse(o()(t.snap))}).catch(function(t){}):this.isCanUpload=!1},afterUpload:function(t){this.pic_ids=t},edit:function(t){var i=this;n.i(u.e)(t).then(function(t){i.$message.success("更新相册成功"),i.getPhotos()})},uploadSubmit:function(){var t={id:this.albumInfo.id,pic_ids:this.pic_ids};this.edit(t),this.isCanUpload=!1},editSubmit:function(){var t={id:this.albumInfo.id,title:this.albumInfo.title,store_id:this.albumInfo.store_id,cover_id:this.albumInfo.cover_id};this.edit(t),this.isEdit=!1},delAlbum:function(t,i){var e=this;this.$confirm("确定删除相册《"+i+"》？").then(function(i){n.i(u.c)({id:t}).then(function(t){e.$message.success("删除相册成功"),v.a.push({name:"门店展示"})})}).catch(function(t){})}}}},Kmq7:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=n("ocgh"),o=(n("7+uW"),n("0xDb"));i.default={props:{photoList:{type:Array},isCanUpload:{type:Boolean,default:!0}},data:function(){return{isUploaded:!1,prevPhotos:!1,prevPhotoUrl:""}},methods:{emitFile:function(){this.$refs.multipleFile.click()},uploadPhotos:function(t){for(var i=this,a=t.target.files,s=a.length,r=[],l=0;l<s;l++)r[l]=!1;for(var d=[],c=0;c<s;c++)!function(t){var l=a[t];n.i(o.b)(l).then(function(o){n.i(e.c)(o.formData).then(function(n){r[t]=!0;var e={pic_url:"http://"+n.data.pic_address,pic_id:n.data.pic_id};i.photoList.push(e),i.$forceUpdate();for(var o=!0,a=0;a<s;a++)if(!r[a]){o=!1;break}if(o){i.isUploaded=!0;var l=i.photoList.map(function(t){return t.pic_id});i.$emit("afterUpload",l.join(",")),d.length&&i.$message.error("第"+d.join(", ")+"张图片出错，可能原因是图片大于5MB！")}})}).catch(function(n){r[t]=!0,d.push(t+1);for(var e=!0,o=0;o<s;o++)if(!r[o]){e=!1;break}if(e){i.isUploaded=!0;var a=i.photoList.map(function(t){return t.pic_id});i.$emit("afterUpload",a.join(",")),d.length&&i.$message.error("第"+d.join(", ")+"张图片出错，可能原因是图片大于5MB！")}})}(c)},showPrevPhotos:function(t){this.prevPhotos=!0,this.prevPhotoUrl=t},delPhoto:function(t){this.photoList.splice(t,1);var i=this.photoList.map(function(t){return t.pic_id});this.$emit("afterUpload",i.join(",")),this.$forceUpdate()}}}},Xd32:function(t,i,n){n("+tPU"),n("zQR9"),t.exports=n("5PlU")},d7EF:function(t,i,n){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=n("us/S"),a=e(o),s=n("BO1k"),r=e(s);i.default=function(){function t(t,i){var n=[],e=!0,o=!1,a=void 0;try{for(var s,l=(0,r.default)(t);!(e=(s=l.next()).done)&&(n.push(s.value),!i||n.length!==i);e=!0);}catch(t){o=!0,a=t}finally{try{!e&&l.return&&l.return()}finally{if(o)throw a}}return n}return function(i,n){if(Array.isArray(i))return i;if((0,a.default)(Object(i)))return t(i,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},fxRn:function(t,i,n){n("+tPU"),n("zQR9"),t.exports=n("g8Ux")},g8Ux:function(t,i,n){var e=n("77Pl"),o=n("3fs2");t.exports=n("FeBl").getIterator=function(t){var i=o(t);if("function"!=typeof i)throw TypeError(t+" is not iterable!");return e(i.call(t))}},mvHQ:function(t,i,n){t.exports={default:n("qkKv"),__esModule:!0}},nFXS:function(t,i,n){t.exports={render:function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"upload-photos"},[n("div",{staticClass:"upload-body"},[t.isCanUpload?n("div",{staticClass:"cover-uploader",on:{click:t.emitFile}},[n("input",{ref:"multipleFile",staticStyle:{opacity:"0",position:"fixed",top:"-1000px"},attrs:{type:"file",accept:"image/*",multiple:"multiple"},on:{change:t.uploadPhotos}}),t._v(" "),n("i",{staticClass:"el-icon-plus cover-uploader-icon"})]):t._e(),t._v(" "),t._l(t.photoList,function(i,e){return n("div",{key:i.pic_id,staticClass:"cover-uploader"},[n("img",{staticClass:"cover-img",attrs:{src:i.pic_url}}),t._v(" "),n("div",{staticClass:"cover-uploader-op"},[n("i",{staticClass:"el-icon-view",on:{click:function(n){t.showPrevPhotos(i.pic_url)}}}),t._v(" "),t.isCanUpload?n("i",{staticClass:"el-icon-delete",on:{click:function(i){t.delPhoto(e)}}}):t._e()])])}),t._v(" "),n("el-dialog",{attrs:{size:"large"},model:{value:t.prevPhotos,callback:function(i){t.prevPhotos=i},expression:"prevPhotos"}},[n("img",{staticStyle:{"max-width":"100%","max-height":"100%"},attrs:{src:t.prevPhotoUrl,alt:""}})])],2)])},staticRenderFns:[]},t.exports.render._withStripped=!0},qkKv:function(t,i,n){var e=n("FeBl"),o=e.JSON||(e.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},"tc/W":function(t,i,n){t.exports={render:function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"app-container store-album"},[n("div",{staticClass:"header"},[n("div",{staticClass:"album-info"},[t.isEdit?t._e():n("img",{staticClass:"cover",attrs:{src:t.albumInfo.cover_pic?"http://"+t.albumInfo.cover_pic:""}}),t._v(" "),t.isEdit?n("div",{staticClass:"cover-uploader",on:{click:t.emitFile}},[n("input",{ref:"file",staticStyle:{opacity:"0",position:"fixed",top:"-1000px"},attrs:{type:"file",accept:"image/*"},on:{change:t.upload}}),t._v(" "),t.albumInfo.cover_pic?n("img",{staticClass:"cover-img",attrs:{src:t.albumInfo.cover_pic?"http://"+t.albumInfo.cover_pic:""}}):t._e()]):t._e(),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"title"},[t.isEdit?t._e():n("span",[t._v(t._s(t.albumInfo.title))]),t.isEdit?n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.albumInfo.title,callback:function(i){t.albumInfo.title=i},expression:"albumInfo.title"}}):t._e()],1),t._v(" "),n("div",{staticClass:"desc"},[t.isEdit?t._e():n("div",{staticClass:"store"},[t._v("门店："+t._s(t.store))]),t._v(" "),t.isEdit?t._e():n("div",{staticClass:"add-time"},[t._v("创建于："+t._s(t.formatDateTime(t.albumInfo.add_time)))]),t._v(" "),t.isEdit?n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.albumInfo.store_id,callback:function(i){t.albumInfo.store_id=i},expression:"albumInfo.store_id"}},t._l(t.storeList,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._e()],1)])]),t._v(" "),n("div",{staticClass:"btn-op"},[t.isEdit?t._e():n("el-button",{attrs:{type:"primary",icon:"edit"},on:{click:t.editBtn}},[t._v("修改")]),t._v(" "),t.isEdit?t._e():n("el-button",{attrs:{type:"danger",icon:"delete"},on:{click:function(i){t.delAlbum(t.albumInfo.id,t.albumInfo.title)}}},[t._v("删除")]),t._v(" "),t.isEdit?n("el-button",{attrs:{type:"primary",disabled:!t.isCanSubmit},on:{click:t.editSubmit}},[t._v("确认")]):t._e(),t._v(" "),t.isEdit?n("el-button",{on:{click:t.cancel}},[t._v("取消")]):t._e()],1)]),t._v(" "),n("div",{staticClass:"btn-upload"},[t.isCanUpload?t._e():n("el-button",{attrs:{type:"primary"},on:{click:t.uploadBtn}},[t._v("编辑图片")]),t._v(" "),t.isCanUpload?n("el-button",{attrs:{type:"primary",disabled:!t.isCanUploadSubmit},on:{click:t.uploadSubmit}},[t._v("确认")]):t._e(),t._v(" "),t.isCanUpload?n("el-button",{on:{click:t.uploadCancel}},[t._v("取消")]):t._e()],1),t._v(" "),n("upload-photos",{attrs:{photoList:t.photoList,isCanUpload:t.isCanUpload},on:{afterUpload:t.afterUpload}})],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},tgDM:function(t,i,n){function e(t){o||n("99FF")}var o=!1,a=n("VU/8")(n("DCXW"),n("tc/W"),e,null,null);a.options.__file="E:\\gitee\\adminPage\\src\\views\\minipage\\storeAlbum.vue",a.esModule&&Object.keys(a.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)}),a.options.functional,t.exports=a.exports},"us/S":function(t,i,n){t.exports={default:n("Xd32"),__esModule:!0}},wD52:function(t,i,n){i=t.exports=n("FZ+f")(!1),i.push([t.i,"\n.cover-uploader {\n  display: inline-block;\n  width: 120px;\n  height: 120px;\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n  margin: 10px;\n}\n.cover-uploader:hover {\n  border-color: #20a0ff;\n}\n.cover-uploader:hover .cover-uploader-op {\n    opacity: 1;\n}\n.cover-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 120px;\n  height: 120px;\n  line-height: 120px;\n  text-align: center;\n}\n.cover-uploader-op {\n  opacity: 0;\n  transition: opacity 0.3s;\n  position: absolute;\n  top: 0;\n  left: 0;\n  font-size: 20px;\n  color: #fff;\n  width: 120px;\n  height: 120px;\n  line-height: 120px;\n  text-align: center;\n  background: rgba(0, 0, 0, 0.3);\n}\n.cover-img {\n  width: 120px;\n  height: 120px;\n  display: block;\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n.upload-photos {\n  margin-bottom: 20px;\n}\n.upload-photos .upload-body {\n    padding: 10px;\n    border: 1px solid #bfcbd9;\n    font-size: 0;\n}\n.upload-photos .el-dialog__body {\n    text-align: center;\n}\n",""])},xUx1:function(t,i,n){"use strict";function e(t){return n.i(l.a)({url:"/api/album/add",method:"post",data:d.stringify(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function o(t){return n.i(l.a)({url:"/api/album/lists",method:"post",data:d.stringify(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function a(t){return n.i(l.a)({url:"/api/album/delete",method:"post",data:d.stringify(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function s(t){return n.i(l.a)({url:"/api/album/info",method:"post",data:d.stringify(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function r(t){return n.i(l.a)({url:"/api/album/edit",method:"post",data:d.stringify(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}i.b=e,i.a=o,i.c=a,i.d=s,i.e=r;var l=n("k97f"),d=n("mw3O")},znm1:function(t,i,n){i=t.exports=n("FZ+f")(!1),i.push([t.i,'\n.store-album .header {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  background: #fff;\n  padding: 20px;\n  border: 1px solid #e3e8f0;\n  margin-bottom: 20px;\n}\n.store-album .header .album-info {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: start;\n        -ms-flex-pack: start;\n            justify-content: flex-start;\n    font-size: 20px;\n    line-height: 2;\n}\n.store-album .header .album-info .cover {\n      width: 80px;\n      height: 80px;\n      margin-right: 20px;\n      -o-object-fit: cover;\n         object-fit: cover;\n}\n.store-album .header .album-info .cover-uploader {\n      width: 80px;\n      height: 80px;\n      border: 1px dashed #d9d9d9;\n      border-radius: 6px;\n      cursor: pointer;\n      position: relative;\n      overflow: hidden;\n      margin: 0;\n      margin-right: 20px;\n}\n.store-album .header .album-info .cover-uploader:hover {\n      border-color: #20a0ff;\n}\n.store-album .header .album-info .cover-img {\n      width: 80px;\n      height: 80px;\n      display: block;\n}\n.store-album .header .album-info .info .title {\n      margin-bottom: 10px;\n}\n.store-album .header .album-info .info .desc {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-pack: start;\n          -ms-flex-pack: start;\n              justify-content: flex-start;\n      font-size: 14px;\n      color: #99a9bf;\n}\n.store-album .header .album-info .info .desc > *:not(:first-child):before {\n        content: "/";\n        padding: 0 0.5em;\n}\n.store-album .upload-photos {\n  background: #fff;\n}\n.store-album .btn-upload {\n  padding: 10px;\n}\n',""])},zyxP:function(t,i,n){function e(t){o||n("CdO4")}var o=!1,a=n("VU/8")(n("Kmq7"),n("nFXS"),e,null,null);a.options.__file="E:\\gitee\\adminPage\\src\\components\\uploadPhotos\\index.vue",a.esModule&&Object.keys(a.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)}),a.options.functional,t.exports=a.exports}});
//# sourceMappingURL=2.28a997387c4ddf45ecf7.js.map