webpackJsonp([5],{NUIp:function(e,t,a){function s(e){r||a("aO6W")}var r=!1,i=a("VU/8")(a("j6Lq"),a("owEZ"),s,null,null);i.options.__file="E:\\gitee\\adminPage\\src\\views\\member\\cardEdit.vue",i.esModule&&Object.keys(i.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)}),i.options.functional,e.exports=i.exports},"O5/s":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"\n.info-item {\n  font-size: 14px;\n  padding: 5px 0;\n  line-height: 20px;\n}\n.info-item label {\n  color: #97a8be;\n  font-size: 14px;\n}\n.el-card {\n  margin: 20px 0;\n}\n.el-card:last-of-type {\n    margin-bottom: 0;\n}\n.el-card:first-of-type {\n    margin-top: 0;\n}\n.card-edit .el-form {\n  width: 100%;\n  max-width: 600px;\n}\n",""])},aO6W:function(e,t,a){var s=a("O5/s");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a("rjj0")("976767e4",s,!1)},j6Lq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),r=a.n(s),i=a("Dd8w"),n=a.n(i),o=a("ocgh"),l=a("NYxO"),m=a("YaEn");t.default={data:function(){return{isRenew:!1,isStop:!1,renew:{member_id:"",day:"",remark:""},renewRules:{day:[{required:!0,message:"不能为空",trigger:"blur"},{validator:function(e,t,a){if(t<0)return a(new Error("续卡天数不能为负"));a()},trigger:"blur"}],remark:[{required:!0,message:"请填写备注",trigger:"blur"}]},stop:{member_id:"",remark:"",day:"",stop_start_time:"",stop_end_time:""},stopRules:{stop_start_time:[{required:!0,message:"请填写备注",trigger:"blur"}],remark:[{required:!0,message:"请填写备注",trigger:"blur"}]},stopRange:[],editType:"年"}},computed:n()({},a.i(l.b)(["memberInfo","isGettingInfo"]),{isCanRenew:function(){return this.renew.member_id&&this.renew.day&&this.renew.remark},isCanStop:function(){return this.stop.member_id&&this.stop.stop_start_time&&this.stop.stop_end_time&&this.stop.remark},stopDays:function(){return Math.round((this.stop.stop_end_time-this.stop.stop_start_time)/86400)},typeLabel:function(){return this.editType+"数"}}),watch:{stopRange:function(){this.watchStopRange()}},created:function(){this.init();var e={mobile:"",id:this.$route.params.id};this.memberInfo||this.getMemberInfo(e)},methods:n()({},a.i(l.d)({getMemberInfo:"member/getInfo"}),{init:function(){this.isRenew="会员卡续卡"===this.$route.name,this.isStop=!this.isRenew,this.renew.member_id=this.$route.params.id,this.stop.member_id=this.$route.params.id},renewCard:function(){var e=this;this.$refs.renew.validate(function(t){if(!t)return e.$message.error("提交失败，请检查表单！"),!1;var s=JSON.parse(r()(e.renew));s.day=e.formatXukaDay(s.day),a.i(o.i)(s).then(function(t){var a={mobile:"",id:e.$route.params.id};e.getMemberInfo(a),m.a.push({name:"会员资料",params:{id:e.$route.params.id}})})})},stopCard:function(){var e=this;this.isCanStop&&(this.stop.day=this.stopDays,a.i(o.j)(this.stop).then(function(t){var a={mobile:"",id:e.$route.params.id};e.getMemberInfo(a),m.a.push({name:"会员资料",params:{id:e.$route.params.id}})}))},watchStopRange:function(){this.stopRange[0]?(this.stop.stop_start_time=Math.round(this.stopRange[0].getTime()/1e3),this.stop.stop_end_time=Math.round(this.stopRange[1].getTime()/1e3)):(this.stop.stop_start_time=null,this.stop.stop_end_time=null)},cardEndTime:function(e){var t=Math.round((new Date).getTime()/1e3),a=Math.round((e-t)/86400);return a>=0?"还有"+a+"天到期":"已到期"},formatXukaDay:function(e){e=+e;var t=new Date(1e3*this.memberInfo.card_end_time),a=t.getFullYear(),s=t.getMonth(),r=t.getDate(),i=void 0;switch(this.editType){case"年":i=Math.round((new Date(a+e,s,r).getTime()-t.getTime())/864e5);break;case"月":i=Math.round((new Date(a,s+e,r).getTime()-t.getTime())/864e5);break;case"天":default:i=e}return i}})}},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},owEZ:function(e,t,a){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container card-edit"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"36px"}},[e._v("会员卡信息")])]),e._v(" "),a("div",{staticClass:"text item"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("会员: ")]),e._v(" "),a("span",[e._v(e._s(e.memberInfo.name))])]),e._v(" "),a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("会员卡类型: ")]),e._v(" "),a("span",[e._v(e._s(1===e.memberInfo.card_type?"期限卡":"次卡"))])]),e._v(" "),a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("会员卡名称: ")]),e._v(" "),a("span",[e._v(e._s(e.memberInfo.card_type_name))])]),e._v(" "),a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("会员卡创建时间: ")]),e._v(" "),a("span",[e._v(e._s(e.moment(1e3*e.memberInfo.add_time).format("YYYY-MM-DD HH:mm")))])]),e._v(" "),a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("实体卡号: ")]),e._v(" "),a("span",[e._v(e._s(e.memberInfo.card_id||"未设置"))])]),e._v(" "),a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("有效期: ")]),e._v(" "),a("span",[e._v(e._s(e.moment(1e3*e.memberInfo.card_start_time).format("YYYY-MM-DD")+" 至 "+e.moment(1e3*e.memberInfo.card_end_time).format("YYYY-MM-DD")))])]),e._v(" "),a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("剩余天数: ")]),e._v(" "),a("span",[e._v(e._s(e.cardEndTime(e.memberInfo.card_end_time)))])]),e._v(" "),a("el-col",{staticClass:"info-item",attrs:{sm:12}},[a("label",[e._v("场馆: ")]),e._v(" "),a("span",[e._v(e._s(1===e.memberInfo.store_id?"英威尔海德店":"英威尔龙珠店"))])])],1)],1)]),e._v(" "),e.isRenew?a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"36px"}},[e._v("会员卡续卡")])]),e._v(" "),a("div",{staticClass:"text"},[a("el-form",{ref:"renew",attrs:{rules:e.renewRules,model:e.renew,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"续卡方式"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editType,callback:function(t){e.editType=t},expression:"editType"}},[a("el-option",{attrs:{label:"年",value:"年"}}),e._v(" "),a("el-option",{attrs:{label:"月",value:"月"}}),e._v(" "),a("el-option",{attrs:{label:"天",value:"天"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.typeLabel,prop:"day"}},[a("el-input",{attrs:{type:"number"},model:{value:e.renew.day,callback:function(t){e.renew.day=t},expression:"renew.day"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.renew.remark,callback:function(t){e.renew.remark=t},expression:"renew.remark"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",disabled:!e.isCanRenew},on:{click:e.renewCard}},[e._v("保存")])],1)],1)]):e._e(),e._v(" "),e.isStop?a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"36px"}},[e._v("会员卡停卡")])]),e._v(" "),a("div",{staticClass:"text"},[a("el-form",{ref:"stop",attrs:{rules:e.stopRules,model:e.stop,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"停卡时间",prop:"stop_start_time"}},[a("el-date-picker",{attrs:{type:"daterange",placeholder:"选择日期范围"},model:{value:e.stopRange,callback:function(t){e.stopRange=t},expression:"stopRange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.stop.remark,callback:function(t){e.stop.remark=t},expression:"stop.remark"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",disabled:!e.isCanStop},on:{click:e.stopCard}},[e._v("保存")])],1)],1)]):e._e()],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},qkKv:function(e,t,a){var s=a("FeBl"),r=s.JSON||(s.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}}});
//# sourceMappingURL=5.5f11cf20e567f11e6c7f.js.map